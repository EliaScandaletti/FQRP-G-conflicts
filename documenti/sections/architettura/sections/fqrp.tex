\documentclass[../../../relazione.tex]{subfiles}

\begin{document}

All'interno del namespace \texttt{fqrp}, oltre a essere implementate le componenti definite nel namespace \texttt{core}, vengono anche definiti i tipi che saranno argomento dei template.

\paragraph{Tipi primitivi}
Vengono definiti i seguenti tipi primitivi:
\begin{itemize}
    \item \texttt{vehicle\_t}: \texttt{unsigned int} a 32 bit,rappresenta un veicolo;
    \item \texttt{count\_t}: \texttt{unsigned int} a 64 bit, tipo usato per contare i conflitti che sono al più $(2^{32})^2$.
\end{itemize}

\paragraph{Classe Instance} rappresenta un'istanza FQRP- ed espone i seguenti metodi:
\begin{itemize}
    \item \texttt{vehicle\_t size() const}: ritorna la dimensione dell'istanza;
    \item \texttt{vehicle\_t sigma(vehicle\_t vehicle) const}: dato un veicolo \texttt{vehicle} ritorna la sua destinazione.
\end{itemize}

\paragraph{Valori cumulativi}
Per rappresentare i dati cumulativi vengono utilizzate le seguenti strutture:
\begin{itemize}
    \item \texttt{dist\_count}: rappresenta il dato aggregato del problema. \\
          Espone il metodo:
          \begin{itemize}
              \item \texttt{size\_t sample\_size() const}: ritorna il numero di campioni usati per costruire il dato aggregato.
          \end{itemize}
          Espone i membri:
          \begin{itemize}
              \item \texttt{utils::distribution arcType}: distribuzione del numero dei conflitti di arco;
              \item \texttt{utils::distribution AType}: distribuzione del numero dei conflitti di tipo A;
              \item \texttt{utils::distribution BType}: distribuzione del numero dei conflitti di tipo B;
              \item \texttt{c\_graph\_dist\_t c\_graph\_dist}: distribuzione dei grafi dei conflitti di tipo C;
              \item \texttt{forest\_dist\_t mixed\_forest\_dist}: distribuzione dei grafi dei conflitti di tipo misto.
          \end{itemize}
    \item \texttt{c\_graph\_dist\_t}: rappresenta la distribuzione dei grafi dei conflitti di tipo C. \\
          Espone i membri:
          \begin{itemize}
              \item \texttt{utils::distribution max\_length}: distribuzione della lunghezza massima delle catene di conflitti di tipo C;
              \item \texttt{utils::distribution tree\_num}: distribuzione del numero di alberi all'interno della foresta di conflitti di tipo C;
              \item \texttt{utils::distribution arcs\_num}: distribuzione del numero di conflitti di tipo C;
              \item \texttt{utils::distribution chain\_num}: distribuzione del numero di catene di conflitti di tipo C;
              \item \texttt{utils::distribution vehicles\_num}: distribuzione del numero di veicoli coinvolti in conflitti di tipo C.
          \end{itemize}
    \item \texttt{forest\_dist\_t}: rappresenta la distribuzione dei grafi dei conflitti di tipo misto. \\
          Espone i membri:
          \begin{itemize}
              \item \texttt{utils::distribution tree\_num}: distribuzione del numero di alberi all'interno della foresta di conflitti di tipo misto;
              \item \texttt{utils::distribution max\_tree\_size}: distribuzione del numero massimo di veicoli coinvolti nello stessa componente connessa del grafo di conflitti;
              \item \texttt{utils::distribution nodes\_num}: distribuzione del numero di veicoli coinvolti in conflitti di tipo misto;
              \item \texttt{utils::distribution edges\_num}: distribuzione del numero di conflitti di tipo misto.
          \end{itemize}
\end{itemize}

\paragraph{Generatori}
Vengono implementati i seguenti generatori:
\begin{itemize}
    \item \texttt{ExhaustiveGenerator}: genera tutte le istanze di una data dimensione. Applica l'algoritmo di Heap riadattato per ottenere una generazione lazy delle permutazioni.
    \item \texttt{RandomGenerator}: genera istanze casuali. Implementa l'algoritmo di Fisher-Yates.
    \item \texttt{IntervalGenerator}: applica l'algoritmo descritto nella sezione \ref{alg_gen:int}.
    \item \texttt{FilteredGenerator}: applica un filtro a un generatore interno. In particolare, chiede al generatore interno di generare istanze e le accetta solo se superano il filtro dato.
\end{itemize}

\paragraph{Filtri}
Vengono implementati i seguenti filtri:
\begin{itemize}
    \item \texttt{Not}: nega un filtro passatogli come parametro di tipo.
    \item \texttt{IsPartitioned}: accetta istanze solo se queste sono partizionate.
    \item \texttt{ExcludeSymmetric}: per ogni coppia di istanze di cui una è simmetrica all'altra, ne accetta solo una.
\end{itemize}

\paragraph{Generazione benchmark}
Per la generazione del benchmark di istanze interessanti viene utilizzata la classe \texttt{logger\_t}.
Il costruttore della classe accetta come parametro un puntatore a una funzione del tipo \texttt{bool func(const Instance \&, const conflictCount \&)}.
Inoltre, accetta un output stream che, di default, è quello standard.

La classe implementa l'\texttt{operator()(const Instance \&instance, const conflictCount \&count)} in modo tale che se la funzione ricevuta dal costruttore ritorna vero con gli stessi parametri, allora l'istanza ricevuta viene scritta nell'output stream ricevuto dal costruttore.

Gli oggetti di tipo \texttt{logger\_t} vengono passati al costruttore della classe \texttt{conflictCounter} che, ogni volta che un'istanza viene analizzata, passa l'istanza stessa e il risultato ottenuto al logger attraverso il suo \texttt{operator()}.

I criteri utilizzati sono stati i seguenti:
\begin{itemize}
    \item il grafo dei conflitti misti dell'istanza non è una foresta;
    \item la lunghezza della catena massima di conflitti di tipo C dell'istanza è maggiore o uguale al 90\% della lunghezza massima teorica;
    \item il numero di conflitti misti è maggiore o uguale al 50\% del numero di conflitti di tipo B.
\end{itemize}
Tutti e tre i criteri sono stati applicati col generatore casuale con filtro a posteriori e alle sole istanze di dimensione minima 16.

\end{document}