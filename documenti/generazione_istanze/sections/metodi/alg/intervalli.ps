function intervalli(size) {
    // indici da 0 a size-1
    // veicoli da 1 a size
    // il valore 0 indica veicolo non ancora assegnato
    set perm = [0...0] // size elementi
    set maxIntervallo = 0
    set veicoliLiberi = {}
    set destLibere = {}
    
    set pi_1 = randomInt(2, size+1)
    perm[0] = pi_1
    maxIntervallo = pi_1
    for (set i = 1; i < maxIntervallo; i += 1) {
        destLibere.push(i)
        veicoliLiberi.push(i+1)
    }

    while (maxIntervallo < size) {
        set dir = random(0, 1)

        if (dir < 0.5) {    // il prossimo veicolo va a destra
            set pi_next = randomInt(maxIntervallo+1, size+1)
            set k_next = randomFrom(veicoliLiberi)
            veicoliLiberi.pop(k_next)
            perm[k_next-1] = pi_next
            for (set i = maxIntervallo+1; i < pi_next; i += 1) {
                destLibere.push(i)
                veicoliLiberi.push(i)
            }
            veicoliLiberi.push(pi_next)
            maxIntervallo = pi_next

        } else {            // il prossimo veicolo va a sinistra
            set k_next = randomInt(maxIntervallo+1, size+1)
            set pi_next = randomFrom(destLibere)
            destLibere.pop(pi_next)
            perm[k_next-1] = pi_next
            for(set i = maxIntervallo+1; i < k_next; i += 1) {
                destLibere.push(i)
                veicoliLiberi.push(i)
            }
            destLibere.push(k_next)
            maxIntervallo = k_next
        }
    }

    while (veicoliLiberi.size > 0) {
        set k_next = randomFrom(veicoliLiberi)
        set pi_next = randomFrom(veicoliLiberi)
        veicoliLiberi.pop(k_next)
        destLibere.pop(pi_next)
        perm[k_next-1] = pi_next
    }
    
    return perm
}